<!DOCTYPE html>
<html lang="sv">
  <head>
    {% load static %}
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inställningar</title>
    <link rel="stylesheet" href="{% static 'styles.css' %}" />
    <script>
        function openPopup() {
            document.getElementById("transfer-popup").style.display = "flex";
        }

        function closePopup() {
            document.getElementById("transfer-popup").style.display = "none";
        }
    </script>
  </head>
  <body>
    <div class="settings-container">
      <!-- Change later, if time, so user.profile_pic shows here (or default)  -->
      <h1>Inställningar</h1>
      <h2>Administratör för<br>{{organization.name}}</h2>
      <div class="info-table">
        <div class="table-header">Inloggningsuppgifter</div>
        <div class="table-row">
            <div class="label">Namn</div>
            <div class="value"> <!-- Test if username shows up -->
              {{ user.name }} <a href="#"><span class="edit-icon">✏️</span></a>
            </div>
          </div>
        <div class="table-row">
          <div class="label">Lösenord</div>
          <div class="value">
            **************** <a href="#"><span class="edit-icon">✏️</span></a>
          </div>
        </div>
        <div class="table-row">
            <div class="label">Mailadress</div>
            <div class="value">
              {{ user.email }} <!-- Test if user email shows up -->
            </div>
          </div>
        </div>
      <button class="delete-button"onclick="openPopup()">Överlämna organisation</button>


      <!-- Delete Confirmation Popup -->
    <div id="transfer-popup" class="popup-overlay" style="display: none;">
        <div id="content" class="popup-content">
          <form 
            class="transfer-form"
            hx-post="/settings-admin/"
            hx-target="#content"
            hx-trigger="submit"
            hx-swap="outerHTML">

            <span class="close-button" onclick="closePopup()">&times;</span> <!-- &times multiplication symbol -->
            <h2>OBS!</h2>
            <p>Är du säker på att du vill överlämna din organisation?</p>
            <p>Genom att ange en mejladress nedan kommer du att överföra hela din organisation och administratörsrollen till det konto som är kopplat till mejladressen. Ditt konto kommer därefter att tas bort.</p>
            {% csrf_token %}
            <label for="email">Överför till konto:</label>
            <input type="email" id="email" name="email" placeholder="Mejladress"> 
            <button type="submit" class="delete-button">Överlämna organisation</button> <!-- TODO: Fix functionality when clicking on the button. Should check if the given mail address exists in the DB, if not tell user to try again, if exists transfer org to other account, give it admin rights and lastly remove this acc (logout). -->
          </form>
        </div>
    </div>


  </body>
</html>
